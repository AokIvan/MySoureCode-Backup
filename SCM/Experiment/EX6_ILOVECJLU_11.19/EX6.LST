C51 COMPILER V9.01   EX6                                                                   11/19/2021 08:39:15 PAGE 1   


C51 COMPILER V9.01, COMPILATION OF MODULE EX6
OBJECT MODULE PLACED IN EX6.OBJ
COMPILER INVOKED BY: E:\KEIL\C51\BIN\C51.EXE EX6.c BROWSE DEBUG OBJECTEXTEND

line level    source

   1           #include <reg52.h>
   2          
   3          sbit ADDR0 = P1^0;
   4          sbit ADDR1 = P1^1;
   5          sbit ADDR2 = P1^2;
   6          sbit ADDR3 = P1^3;
   7          sbit ENLED = P1^4;
   8          
   9          unsigned char code image[] = {  //图片的字模表
  10              0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x3C,0x18,0x18,0x18,0x18,0x18,0x3C,
  11                  0x00,0x66,0xFF,0xFF,0xFF,0x7E,0x3C,0x18,0x00,0x7E,0x02,0x02,0x02,0x02,0x7E,0x00,
  12                  0x7E,0x30,0x30,0x30,0x32,0x32,0x3E,0x00,0x02,0x02,0x02,0x02,0x02,0x02,0x7E,0x00,
  13                  0x42,0x42,0x42,0x42,0x42,0x7E,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  14          };
  15          
  16          void main()
  17          {
  18   1          EA = 1;       //使能总中断
  19   1          ENLED = 0;    //使能U4，选择LED点阵
  20   1          ADDR3 = 0;
  21   1          TMOD = 0x01;  //设置T0为模式1
  22   1          TH0  = 0xFC;  //为T0赋初值0xFC67，定时1ms
  23   1          TL0  = 0x67;
  24   1          ET0  = 1;     //使能T0中断
  25   1          TR0  = 1;     //启动T0
  26   1          while (1);
  27   1      }
  28          /* 定时器0中断服务函数 */
  29          void InterruptTimer0() interrupt 1
  30          {
  31   1          static unsigned char i = 0;  //动态扫描的索引
  32   1          static unsigned char tmr = 0;  //250ms软件定时器
  33   1          static unsigned char index = 0;  //图片刷新索引
  34   1      
  35   1          TH0 = 0xFC;  //重新加载初值
  36   1          TL0 = 0x67;
  37   1          //以下代码完成LED点阵动态扫描刷新
  38   1          P0 = 0xFF;   //显示消隐
  39   1          switch (i)
  40   1          {
  41   2              case 0: ADDR2=0; ADDR1=0; ADDR0=0; i++; P0=image[index+0]; break;
  42   2              case 1: ADDR2=0; ADDR1=0; ADDR0=1; i++; P0=image[index+1]; break;
  43   2              case 2: ADDR2=0; ADDR1=1; ADDR0=0; i++; P0=image[index+2]; break;
  44   2              case 3: ADDR2=0; ADDR1=1; ADDR0=1; i++; P0=image[index+3]; break;
  45   2              case 4: ADDR2=1; ADDR1=0; ADDR0=0; i++; P0=image[index+4]; break;
  46   2              case 5: ADDR2=1; ADDR1=0; ADDR0=1; i++; P0=image[index+5]; break;
  47   2              case 6: ADDR2=1; ADDR1=1; ADDR0=0; i++; P0=image[index+6]; break;
  48   2              case 7: ADDR2=1; ADDR1=1; ADDR0=1; i=0; P0=image[index+7]; break;
  49   2              default: break;
  50   2          }
  51   1          //以下代码完成每250ms改变一帧图像
  52   1          tmr++;
  53   1          if (tmr >= 250)  //达到250ms时改变一次图片索引
  54   1          {
  55   2              tmr = 0;
C51 COMPILER V9.01   EX6                                                                   11/19/2021 08:39:15 PAGE 2   

  56   2              index++;
  57   2              if (index >= 54)  //图片索引达到32后归零
  58   2              {
  59   3                  index = 0;
  60   3              }
  61   2          }
  62   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    240    ----
   CONSTANT SIZE    =     64    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      3    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
